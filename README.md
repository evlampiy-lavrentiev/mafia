# Камалов Амир, Сервис-ориентированные архитектуры, Мафия

## Общая структура проекта

В папке `server` находятся файлы сервера, в папке `client` - клиента. На сервере реализована инфраструктура для поддержания множественных сессий и чат с поддержкой ролей. По умолчанию сервер запускается на порту `:8080`

## Запуск
Запуск сервера осуществляется через команды сборки и запуска докер контейнера:
```bash
docker build -f server.Dockerfile . -t mafia && docker run -p 8080:8080 mafia
```

Локальный запуск клиента осуществляется из корневой папки проекта командой `go run . --mode=client`.

## Ход игры

У клиента есть набор команд (описание доступно через команду `help`). Сначала необходимо выполнить команду `connect`, ввести адрес сервера c портом (к примеру, `:8080`) и свой ник. В случае успешного подключения вы начнете получать уведомления от сервера, и останется дождаться автоматического начала сессии (от 4 игроков, после чего есть 10 секунд на подключение других участников). После начала сессии новые игроки не могут зайти. В ходе игры вы можете использовать команду `vote`, чтобы проголосовать за убийство одного из игроков или инспекцию игрока (для роли комиссара). Чтобы получить список игроков, используйте `players`. При начале игры вам дается роль, от этого зависит, можете ли голосовать ночью (мафия или комиссар), или нет. Днем комиссар может выполнить команду `expose`, тогда сервер опубликует информацию о мафии, если комиссару удалось ее найти прошлой ночью. День заканчивается, когда все живые игроки выполнят команду `skip` (менять голос до нее можно произвольное число раз, учтен будет последний). Ночью ходят мафия и комиссар через команду `vote`. Также доступен чат для общения через команду `chat` (призраки не могут его использовать, а ночью сообщения отправляются только среди мафии).